{% extends 'base.html' %}
{% load i18n %}
{% block head %}
{{form.media}}
{% endblock %}

{% block content %}
    <h2>{% trans title %}</h2>

    <p>{% trans "Description:" %} {{ org.desc }}</p>
    <p>{% trans "Email:" %} {{ org.mail }}</p>
    <p>{% trans "Phone:" %} {{ org.phone }}</p>
    <p>{% trans "Website:" %} <a href="{{ org.web }}">{{ org.web }}</a></p>

    <h3>{% trans "Locations:" %}</h3>
    <ul>
        {% for location in locations %}
            <li>
                <p>{% trans "Name" %}: {{ location.location_name }}</p>
                <p>{% trans "Address" %}: {{ location.address }}</p>
                <p>{% trans "Open hours" %}: {{ location.open_hours }}</p>
                <!-- Дополнительные поля местоположения -->
                <div id="map" class="map-container"></div>

                <!-- Отображаем медиа для каждого местоположения -->
                <h4>{% trans "Media" %}:</h4>
                <ul>
                    {% for media in location.media.all %}
                    <h5>media.media_id</h5>
                            <li>
                                <img src="{{ media.image.url }}" alt="{{ media.description }}">
                                <p>{{ media.description }}</p>
                            </li>
                    {% endfor %}
                </ul>
            </li>
        {% endfor %}
    </ul>
{% endblock %}


<script>
    // Создаем новую карту Google Maps
    function initMap() {
        // Определяем центр карты
        var center = { lat: YOUR_LATITUDE, lng: YOUR_LONGITUDE };

        // Создаем новую карту в указанном месте
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 12, // Устанавливаем масштаб
            center: center // Устанавливаем центр карты
        });

        // Создаем маркер на карте для каждого местоположения
        {% for location in locations %}
            var locationLatLng = { lat: {{ location.point.latitude }}, lng: {{ location.point.longitude }} };
            var marker = new google.maps.Marker({
                position: locationLatLng,
                map: map,
                title: '{{ location.location_name }}' // Название местоположения
            });
        {% endfor %}
    }
</script>

<script>(g=>{var h,a,k,p="The Google Maps JavaScript API",c="google",l="importLibrary",q="__ib__",m=document,b=window;b=b[c]||(b[c]={});var d=b.maps||(b.maps={}),r=new Set,e=new URLSearchParams,u=()=>h||(h=new Promise(async(f,n)=>{await (a=m.createElement("script"));e.set("libraries",[...r]+"");for(k in g)e.set(k.replace(/[A-Z]/g,t=>"_"+t[0].toLowerCase()),g[k]);e.set("callback",c+".maps."+q);a.src=`https://maps.${c}apis.com/maps/api/js?`+e;d[q]=f;a.onerror=()=>h=n(Error(p+" could not load."));a.nonce=m.querySelector("script[nonce]")?.nonce||"";m.head.append(a)}));d[l]?console.warn(p+" only loads once. Ignoring:",g):d[l]=(f,...n)=>r.add(f)&&u().then(()=>d[l](f,...n))})
            ({key: "AIzaSyBbt_iMBFXcdTSYsEFBnIKvnzgDQV1D92Y", v: "beta"});</script>
