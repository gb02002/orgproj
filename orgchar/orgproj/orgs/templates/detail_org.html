{% extends 'base.html' %}
{% load i18n %}
{% load static %}

{% block title %}{% trans "Organisation's details" %}{% endblock %}

{% block head %}
{{form.media}}
<link rel="stylesheet" type="text/css" href="{% static 'css/detail.css' %}">
{% endblock head %}
<!--Добавить оформление, центрирование-->
{% block content %}
    <div class="organization-details">
        <h2>{{ title }}</h2>

        <div class="org-description">
            <p><strong>{% trans "Description:" %}</strong> {{ org.desc }}</p>
            <p><strong>{% trans "Email:" %}</strong> {{ org.mail }}</p>
            <p><strong>{% trans "Phone:" %}</strong> {{ org.phone }}</p>
            <p><strong>{% trans "Website:" %}</strong> <a href="{{ org.web }}">{{ org.web }}</a></p>
        </div>

        <h3>{% trans "Locations:" %}</h3>
        <ul class="locations-list">
            {% for location in locations %}
                <li class="location-item">
                    <div class="location-details">
                        <p><strong>{% trans "Name" %}:</strong> {{ location.location_name }}</p>
                        <p><strong>{% trans "Address" %}:</strong> {{ location.address }}</p>
                        <p><strong>{% trans "Open hours" %}:</strong> {{ location.open_hours }}</p>
                    </div>

                    <!-- Дополнительные поля местоположения -->
                    <div class="map-container" id="map-{{ location.id }}"></div>

                    <!-- Отображаем медиа для каждого местоположения -->
                    <div class="media-container">
                        <h4><strong>{% trans "Media" %}:</strong></h4>
                        <ul class="media-list">
                            {% for media in location.media.all %}
                                <li class="media-item">
                                    <img src="{{ media.image.url }}" alt="{{ media.description }}">
                                    <p>{{ media.description }}</p>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                </li>
            {% endfor %}
        </ul>
    </div>
{% endblock %}


<script>
    // Создаем новую карту Google Maps
    function initMap() {
        // Определяем центр карты
        var center = { lat: YOUR_LATITUDE, lng: YOUR_LONGITUDE };

        // Создаем новую карту в указанном месте
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 12, // Устанавливаем масштаб
            center: center // Устанавливаем центр карты
        });

        // Создаем маркер на карте для каждого местоположения
        {% for location in locations %}
            var locationLatLng = { lat: {{ location.point.latitude }}, lng: {{ location.point.longitude }} };
            var marker = new google.maps.Marker({
                position: locationLatLng,
                map: map,
                title: '{{ location.location_name }}' // Название местоположения
            });
        {% endfor %}
    }
</script>

<script>(g=>{var h,a,k,p="The Google Maps JavaScript API",c="google",l="importLibrary",q="__ib__",m=document,b=window;b=b[c]||(b[c]={});var d=b.maps||(b.maps={}),r=new Set,e=new URLSearchParams,u=()=>h||(h=new Promise(async(f,n)=>{await (a=m.createElement("script"));e.set("libraries",[...r]+"");for(k in g)e.set(k.replace(/[A-Z]/g,t=>"_"+t[0].toLowerCase()),g[k]);e.set("callback",c+".maps."+q);a.src=`https://maps.${c}apis.com/maps/api/js?`+e;d[q]=f;a.onerror=()=>h=n(Error(p+" could not load."));a.nonce=m.querySelector("script[nonce]")?.nonce||"";m.head.append(a)}));d[l]?console.warn(p+" only loads once. Ignoring:",g):d[l]=(f,...n)=>r.add(f)&&u().then(()=>d[l](f,...n))})
            ({key: "AIzaSyBbt_iMBFXcdTSYsEFBnIKvnzgDQV1D92Y", v: "beta"});</script>
